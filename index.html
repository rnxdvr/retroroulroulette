<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–£–î–ö–ê</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Space+Grotesk:wght@500;600;700&display=swap');
    
        :root { --item-height: 64px; }
    
        html, body { height: 100%; margin: 0; }
    
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: #0f0f11; color: white;
            display: flex; flex-direction: column; min-height: 100vh;
        }
    
        main { flex: 1 0 auto; }
        footer { flex-shrink: 0; }
        .title { font-family: 'Space Grotesk', sans-serif; }
        .reel {
            height: 384px;
            background: linear-gradient(180deg, #18181b 0%, #27272a 100%);
            border: 6px solid #3b82f6;
            box-shadow: 0 0 60px -15px rgb(59 130 246 / 0.6),
                        inset 0 0 40px rgba(255,255,255,0.05);
        }
        .reel-inner {
            transition: transform 5360ms cubic-bezier(0.22, 0.07, 0.10, 0.99);
            will-change: transform;
        }
        .phrase {
            height: var(--item-height);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.35rem; line-height: 1.3; font-weight: 600;
            text-align: center; padding: 0 24px;
            border-bottom: 1px solid rgba(63,63,70,0.4);
        }
        .rarity-common  { color: #e4e4e7; }
        .rarity-rare    { color: #60a5fa; text-shadow: 0 0 10px #60a5fa80; }
        .rarity-epic    { color: #c084fc; text-shadow: 0 0 12px #c084fc90; }
        .rarity-legend  { color: #fbbf24; text-shadow: 0 0 16px #fbbf2490; font-weight: 700; }
        .rarity-mythic  { color: #ef4444; text-shadow: 0 0 20px #ef4444a0; font-weight: 800; letter-spacing: 0.5px; }
        .reel::before, .reel::after {
            content: ''; position: absolute; left: 0; right: 0; height: 80px;
            z-index: 10; pointer-events: none;
        }
        .reel::before { top: 0; background: linear-gradient(to bottom, #18181b, transparent); }
        .reel::after  { bottom: 0; background: linear-gradient(to top, #18181b, transparent); }
        .highlight {
            position: absolute; left: 12px; right: 12px; top: 50%; transform: translateY(-50%);
            height: 72px; border: 3px solid #22d3ee; border-radius: 16px;
            box-shadow: 0 0 0 6px rgba(34,211,238,0.15), 0 0 40px rgba(34,211,238,0.6);
            z-index: 20; pointer-events: none; background: rgba(34,211,238,0.08);
        }
        .glow-btn { transition: all 0.3s cubic-bezier(0.23,1,0.32,1); }
        .glow-btn:hover { box-shadow: 0 0 50px -10px rgb(165 243 252); transform: translateY(-3px) scale(1.03); }

        .modal, .paywall {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85);
            display: none; align-items: center; justify-content: center; z-index: 50;
        }

        .modal-content {
            background: #18181b; border: 2px solid #22d3ee; border-radius: 20px;
            width: 90%; max-width: 500px; height: 85vh; max-height: 85vh;
            display: flex; flex-direction: column; overflow: hidden;
        }

        .modal-header {
            padding: 1.5rem; border-bottom: 1px solid #3f3f46;
            display: flex; justify-content: space-between; align-items: center;
        }

        .modal-body {
            flex: 1; overflow-y: auto; padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem; border-top: 1px solid #3f3f46;
            display: flex; gap: 1rem;
        }

        .paywall-content {
            background: #18181b; border: 2px solid #22d3ee; border-radius: 20px;
            width: 90%; max-width: 480px; padding: 2rem; text-align: center;
        }
        .paywall-content h2 { font-size: 2.2rem; margin-bottom: 1.2rem; color: #ef4444; }
        .paywall-content p { font-size: 1.1rem; margin-bottom: 1.5rem; }
        .paywall-content .btn-group {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem;
        }
        .paywall-content button, .paywall-content a {
            padding: 0.8rem 1.6rem;
            border-radius: 10px; font-size: 1.2rem; font-weight: bold; cursor: pointer;
            min-width: 180px; text-align: center;
        }
        .paywall-content a { background: #ef4444; color: white; text-decoration: none; }
        .paywall-content a:hover { background: #dc2626; }
        .paywall-content button.bg-green { background: #22c55e; color: white; border: none; }
        .paywall-content button.bg-green:hover { background: #16a34a; }
        .paywall-content button.close-btn { background: transparent; color: #9ca3af; font-size: 1rem; margin-top: 1rem; }
        .paywall-content button.close-btn:hover { color: white; }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px 5px rgba(245, 158, 11, 0.4); }
            50%      { box-shadow: 0 0 40px 15px rgba(245, 158, 11, 0.7); }
        }
        .animate-pulse-glow {
            animation: pulse-glow 2.5s infinite ease-in-out;
        }
    </style>
</head>
<body>

    <main class="max-w-lg w-full mx-auto px-6 py-12">
        <div class="text-center mb-10">
            <div class="inline-flex items-center gap-3 mb-4">
                <div class="w-3 h-3 bg-cyan-400 rounded-full animate-pulse"></div>
                <span class="text-cyan-400 text-sm font-medium tracking-[4px] uppercase">—É—Ä–æ–¥–ª–∏–≤—ã–π —Å–≤–∏—Ç–µ—Ä</span>
            </div>
            <h1 class="title text-6xl font-bold tracking-tighter bg-gradient-to-br from-white via-cyan-200 to-violet-300 bg-clip-text text-transparent">
                –ö–†–£–¢–ò –ü–ï–î–ê–õ–ò<br>–î–û–õ–ë–û–ï–ë
            </h1>
            <p class="mt-3 text-zinc-400 text-lg">–ì–û–°–£–î–ê–†–°–¢–í–ï–ù–ù–´–ô –£–ù–ò–í–ï–†–°–ò–¢–ï–¢ –û–¢–ú–ê–ó–û–ö, –§–ê–ö–£–õ–¨–¢–ï–¢ –ò–ó–í–û–†–û–¢–õ–ò–í–û–°–¢–ò, –ö–ê–§–ï–î–†–ê –ò–ù–¢–ï–ù–°–ò–í–ù–û–ì–û –ü–û–•–£–ò–ó–ú–ê –ü–†–ò –ü–û–î–î–ï–†–ñ–ö–ï –ú–ò–ù–ò–°–¢–ï–†–°–¢–í–ê –û–¢–ì–û–í–û–†–û–ö –∏–º. xddReTro</p>
        </div>

        <div class="relative mb-10">
            <div id="reel" class="reel mx-auto rounded-3xl overflow-hidden relative">
                <div id="reel-inner" class="reel-inner"></div>
                <div class="highlight"></div>
            </div>
        </div>

        <div class="flex justify-center gap-4">
            <button id="spinBtn" class="glow-btn px-16 py-7 bg-gradient-to-r from-cyan-500 to-violet-600 text-3xl font-bold rounded-3xl shadow-xl flex items-center gap-4 hover:brightness-110">
                <span>–ü–ï–î–ê–õ–¨</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m-7-7v14" />
                </svg>
            </button>
            <button onclick="showModal()" class="px-8 py-7 bg-zinc-800 hover:bg-zinc-700 rounded-3xl text-2xl font-medium transition-colors">üìä</button>
        </div>

        <div id="result" class="hidden mt-12 text-center">
            <div class="text-cyan-400 text-sm font-medium tracking-widest mb-2">–í–´–ü–ê–õ–û</div>
            <div id="winnerText" class="text-3xl leading-tight font-semibold bg-zinc-900 border border-zinc-700 rounded-2xl px-8 py-6 min-h-[140px] flex items-center justify-center shadow-inner"></div>
           
            <div class="flex flex-col sm:flex-row gap-4 justify-center mt-8">
                <button onclick="copyToClipboard()" class="flex-1 py-4 bg-zinc-800 hover:bg-zinc-700 rounded-2xl text-lg font-medium transition-colors flex items-center justify-center gap-2">
                    üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button onclick="spinAgain()" class="flex-1 py-4 bg-gradient-to-r from-cyan-500 to-violet-600 hover:brightness-110 rounded-2xl text-lg font-medium transition-all">
                    –ö–†–£–¢–ò–¢–¨ –ï–©–Å
                </button>
            </div>

            <a href="https://www.donationalerts.com/r/quarkeelite" target="_blank"
               class="mt-14 block w-full max-w-xl mx-auto py-5 px-8 bg-gradient-to-r from-yellow-400 via-amber-500 to-yellow-400 
                      text-black font-bold text-2xl rounded-2xl shadow-2xl shadow-amber-500/50 
                      hover:shadow-amber-500/80 hover:scale-105 transition-all duration-300 animate-pulse-glow">
                –ü–û–î–î–ï–†–ñ–ê–¢–¨ –í–ê–ô–ë–ö–û–î–ò–ù–ì üî•
            </a>
        </div>
    </main>

    <footer class="text-center py-6 text-zinc-600 text-sm border-t border-zinc-800 mt-auto">
        ACCE VIBECODES INC. 2026 ‚Äî ALL RIGHTS RESERVED
    </footer>

    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="text-2xl font-bold text-cyan-400">–î–†–û–ß–ò–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
                <button onclick="hideModal()" class="text-3xl leading-none text-zinc-400 hover:text-white">√ó</button>
            </div>
            <div class="modal-body" id="statsContent"></div>
            <div class="modal-footer">
                <button onclick="resetStats()" class="flex-1 py-4 bg-red-600 hover:bg-red-700 rounded-2xl text-lg font-medium transition-colors">–°–ë–†–û–°–ò–¢–¨ –í–°–Å</button>
                <button onclick="hideModal()" class="flex-1 py-4 bg-zinc-700 hover:bg-zinc-600 rounded-2xl text-lg font-medium transition-colors">–ó–ê–ö–†–´–¢–¨</button>
            </div>
        </div>
    </div>

    <div id="paywall" class="paywall">
        <div class="paywall-content">
            <h2>–≠–≠–≠ –õ–£–î–ò–ö –¢–´ –ö–£–î–ê –õ–ï–ó–ï–® –ë–†–ê–¢</h2>
            <p class="text-xl text-zinc-300 mb-6">
                –ü–µ—Ä–≤—ã–µ 5 —Å–ø–∏–Ω–æ–≤ –±—ã–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ.<br>
                –•–æ—á–µ—à—å –¥–∞–ª—å—à–µ –≥—ç–º–±–ª–∞ ‚Äî –∂–µ—Ä—Ç–≤—É–π 69‚ÇΩ –∏ –±—É–¥–µ—Ç –∞–Ω–ª–∏–º –Ω–∞ 12 —á–∞—Å–æ–≤. –õ–∏–±–æ –∂–¥–∏ —á–∞—Å, –∫–¥ —Å–±—Ä–æ—Å–∏—Ç—Å—è
            </p>
            <div class="btn-group">
                <a href="https://www.donationalerts.com/r/quarkeelite" target="_blank">–ñ–ï–†–¢–í–û–í–ê–¢–¨</a>
                <button class="bg-green" onclick="markAsDonated(); document.getElementById('paywall').style.display='none'; alert('–°–ø–∞—Å–∏–±–æ, –±—Ä–∞—Ç! –¢–µ–ø–µ—Ä—å –∫—Ä—É—Ç–∏ 12 —á–∞—Å–æ–≤ –∞–Ω–ª–∏–º üí™');">
                    –Ø –£–ñ–ï –ñ–ï–†–¢–í–û–í–ê–õ, LEMME IN
                </button>
            </div>
            <button class="close-btn" onclick="document.getElementById('paywall').style.display='none'">
                √ó –ó–∞–∫—Ä—ã—Ç—å (–Ω–æ —Å–ø–∏–Ω –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è)
            </button>
        </div>
    </div>

    <audio id="startSound" preload="auto"><source src="1.mp3" type="audio/mpeg"></audio>
    <audio id="endSound" preload="auto"><source src="2.mp3" type="audio/mpeg"></audio>

    <script>
        const excuses = [
            {text: "–±–ª—è –ª–µ–Ω—å", rarity: "common"},
            {text: "–Ω–µ—Ç –≤–∞–π–±–∞", rarity: "common"},
            {text: "—Å–ø–∞—Ç—å –ø–∏–∑–¥–µ—Ü —Ö–æ—á–µ—Ç—Å—è", rarity: "common"},
            {text: "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤ –æ—á–∫–µ", rarity: "common"},
            {text: "–≤–ø–∞–¥–ª—É –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å", rarity: "common"},
            {text: "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≥–æ–≤–Ω–æ —Å–µ–≥–æ–¥–Ω—è", rarity: "legend"},
            {text: "–º–∏–∫—Ä–æ—Ñ–æ–Ω –±–µ–∑ –ø–∞—É–∫–∞", rarity: "rare"},
            {text: "–±–∞—à–∫–∞ —Ç—Ä–µ—â–∏—Ç", rarity: "rare"},
            {text: "–Ω–µ —Å–µ–≥–æ–¥–Ω—è", rarity: "legend"},
            {text: "–∫–ª–æ—É–Ω—Å–∫–≤–∞–¥ –º–µ—à–∞–µ—Ç —Ç–∞–π–º–∏–Ω–≥–∞–º–∏", rarity: "mythic"},
            {text: "—á–∞—Ç –ø—É—Å—Ç–æ–π –±—É–¥–µ—Ç", rarity: "common"},
            {text: "—É—á–µ–±–∞ –¥—É—à–∏—Ç –±–∞–ª—è", rarity: "common"},
            {text: "—Ç–æ—á–Ω–æ –∑–∞–≤—Ç—Ä–∞ –≤ 3", rarity: "common"},
            {text: "–¥–µ–ø—Ä–µ—Å—Å–∏—è –≤ 0 –ª–µ—Ç", rarity: "legend"},
            {text: "–Ω–µ—Ç —Å–≤–µ—Ç–∞", rarity: "legend"},
            {text: "OBS –≤—ã–ª–µ—Ç–∞–µ—Ç", rarity: "common"},
            {text: "–¥—É—à–Ω–æ—Å—Ç—å –±—ã—Ç–∏—è", rarity: "common"},
            {text: "–ª–µ–Ω—å –¥–∞–∂–µ OBS –æ—Ç–∫—Ä—ã–≤–∞—Ç—å", rarity: "common"},
            {text: "—Ö–æ—á—É —Å–ª–∞–¥–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫", rarity: "rare"},
            {text: "—â–∞—Å –Ω–∞—á–Ω—É ‚Äî —Å—Ä–∞–∑—É —Å–ø–∞—Ç—å –∑–∞—Ö–æ—á—É", rarity: "common"},
            {text: "–≥–æ –≤ —Å—Ä–∞—Ä–∫", rarity: "rare"},
            {text: "–Ω–µ —Ç—è–Ω–µ—Ç", rarity: "common"},
            {text: "—Ç—ã –≤–æ–Ω—è–µ—à—å —Ç—ã –≤–æ–Ω—è–µ—à—å", rarity: "mythic"},
            {text: "–ø–∞–Ω—Ç–æ–≥—Ä–∞—Ñ –¥—Ä–æ—á—É", rarity: "mythic"},
            {text: "–±–µ—Å–∏—Ç–µ", rarity: "common"},
            {text: "–∑–∞–≤—Ç—Ä–∞ –Ω–∞ —É—á–µ–±—É", rarity: "mythic"},
            {text: "–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç–æ–º", rarity: "legend"},
            {text: "—á–∞—Ç —Ç–æ–∫—Å–∏—á–Ω—ã–π –±—É–¥–µ—Ç", rarity: "common"},
            {text: "–ø—Ä–æ—Å—Ç–æ –Ω–µ —Ö–æ—á—É", rarity: "common"},
            {text: "—Ö–æ—á—É –∫–∞–∫–∞—Ç—å", rarity: "legend"},
            {text: "—â–∞—Å –ª—è–≥—É –∏ –≤—ã—Ä—É–±–ª—é—Å—å", rarity: "common"},
            {text: "—Ö–æ—á—É —Ö–æ—Ç–ª–∞–ø–∏—Ç—å —Å –≥—É–Ω –≥—É–Ω–Ω–µ—Ç", rarity: "mythic"},
            {text: "—â–∞—Å –∫–ª–æ—É–Ω –∑–∞–ø—É—Å—Ç–∏—Ç, —Å–º—ã—Å–ª?", rarity: "rare"},
            {text: "–¥—Ä–æ—á—É—Å—å –≤ –∏–∫—Å–µ", rarity: "epic"},
            {text: "–∂–¥—É –º–æ–Ω–∏—Ç–æ—Ä", rarity: "epic"},
            {text: "–≤–ø–∞–¥–ª—É –±—Ä–æ", rarity: "common"},
            {text: "–±–µ–∑ –ø–∏–≤–∞ –Ω–µ —Ö–æ—á–µ—Ç—Å—è –∫–∞—Å—Ç–∏—Ç—å, –∞ –ø–∏–≤–∞ –Ω–µ —Ö–æ—á–µ—Ç—Å—è", rarity: "common"},
            {text: "–ø–æ—Ö, –Ω–∏–∫—Ç–æ –Ω–µ –∂–¥—ë—Ç", rarity: "epic"},
            {text: "—Å—Ä–∞–∑—É —Ä–∞—Å—Ö–æ—Ç–µ–ª–æ—Å—å", rarity: "epic"},
            {text: "–ª–µ–Ω—å –ø–∏–∑–¥–µ—Ü", rarity: "common"},
            {text: "–∏–≥—Ä–∞—é, —Å–æ—Ä–∏", rarity: "epic"},
            {text: "—â–∞—Å –ª—É—á—à–µ –Ω–µ –Ω–∞–¥–æ", rarity: "common"},
            {text: "—Å–º–µ—Ä—Ç—å –≤ –Ω–∏—â–∏—Ç–µ", rarity: "legend"},
            {text: "—Å–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å-–ø–µ—Ä–¥–µ–Ω—å", rarity: "epic"},
            {text: "–ø—Ä–æ—Å—Ç–æ –Ω–µ —Å—É–¥—å–±–∞ —Å–µ–≥–æ–¥–Ω—è", rarity: "common"},
            {text: "—è –¥—Ä–æ—á–∏–ª–∞ –ø—Ä–æ—Å—Ç–æ", rarity: "mythic"},
            {text: "–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É —Ä–∞–∑–≥–æ–Ω—è—é", rarity: "legend"},
            {text: "—è —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Å—É –¥—Ä–æ—á—É", rarity: "mythic"},
            {text: "–≤—Å–µ –±—É–¥–µ—Ç –ø–∞—Ä–Ω–∏, –ø—Ä–æ—Å—Ç–æ –Ω–µ —Å–µ–π—á–∞—Å", rarity: "legend"},
            {text: "–Ω–æ—á—å—é –≤–æ –≤—Ä–µ–º—è —Å–µ–º–µ—Å—Ç—Ä–∞ —è –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–∏—Ö—É—è –Ω–µ —Å–º–æ–≥—É", rarity: "epic"},
            {text: "–ø–µ—Ä–µ—Å–¥–∞—á–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã —Ö—É–π–ª—É—à–Ω—ã—Ö –æ—Ç–≥–æ–≤–æ—Ä–æ–∫", rarity: "legend"},
            {text: "—Å—á—ë—Ç—á–∏–∫ –∫–æ–≥–¥–∞ –º–µ–Ω—è –∑–≤–∞–ª–∏ –∏–≥—Ä–∞—Ç—å –ø–æ –ø—Ä–µ–∂–Ω–µ–º—É –Ω–æ–ª—å", rarity: "epic"},
            {text: "–Ø –µ—â—ë –Ω–µ –≤—Å—ë –±—É–∫–≤—ã –≤ –∞–ª—Ñ–∞–≤–∏—Ç–µ –æ—Å–≤–æ–∏–ª", rarity: "mythic"},
            {text: "—Å–∫–∏–ª–ª –∏—Å—Å—É–µ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª", rarity: "epic"},
            {text: "–æ–¥–∏–Ω —Ä–∞–∑ –∂–∏–≤–µ–º, –º–Ω–æ–≥–æ —Ä–∞–∑ —Å—Ä—ë–º", rarity: "mythic"},
            {text: "üêó –º—É–∂–∏–∫–∏, –Ω–µ —à–º–∞–ª—è–π—Ç–µ, —É –º–µ–Ω—è –±–ª–∞–Ω–∫ –æ—Ç–≤–∞–ª–∏–ª—Å—è üêó", rarity: "common"}
        ];

        const RARITY_WEIGHTS = { common: 55, rare: 25, epic: 12, legend: 6, mythic: 2 };
        const RARITY_ORDER = ["mythic", "legend", "epic", "rare", "common"];
        const RARITY_CLASSES = {
            common: "rarity-common",
            rare: "rarity-rare",
            epic: "rarity-epic",
            legend: "rarity-legend",
            mythic: "rarity-mythic"
        };

        const ITEM_HEIGHT = 64;
        const NUM_COPIES = 12;
        const FREE_SPINS = 5;
        const FREE_PERIOD_MS = 60 * 60 * 1000;
        const DONATED_KEY = "donatedRetro";
        const DONATED_EXPIRY = 12 * 60 * 60 * 1000;

        let isSpinning = false;
        let stats = JSON.parse(localStorage.getItem("retroStats") || "{}");

        function getFreeSpinsData() {
            const data = JSON.parse(localStorage.getItem("freeSpinsData") || "{}");
            return {
                count: data.count || 0,
                firstSpinTime: data.firstSpinTime || null
            };
        }

        function saveFreeSpinsData(count, firstTime) {
            localStorage.setItem("freeSpinsData", JSON.stringify({
                count,
                firstSpinTime: firstTime
            }));
        }

        function canSpinForFree() {
            const { count, firstSpinTime } = getFreeSpinsData();
            const now = Date.now();
            if (firstSpinTime && now - firstSpinTime >= FREE_PERIOD_MS) {
                saveFreeSpinsData(0, null);
                return true;
            }
            return count < FREE_SPINS;
        }

        function useFreeSpin() {
            let { count, firstSpinTime } = getFreeSpinsData();
            const now = Date.now();
            if (count === 0) firstSpinTime = now;
            count++;
            saveFreeSpinsData(count, firstSpinTime);
        }

        function isDonated() {
            const data = JSON.parse(localStorage.getItem(DONATED_KEY) || "{}");
            if (data.timestamp && Date.now() - data.timestamp < DONATED_EXPIRY) {
                return true;
            }
            return false;
        }

        function markAsDonated() {
            localStorage.setItem(DONATED_KEY, JSON.stringify({
                timestamp: Date.now()
            }));
        }

        function showPaywall() {
            document.getElementById('paywall').style.display = 'flex';
        }

        function createReel() {
            const reelInner = document.getElementById('reel-inner');
            reelInner.innerHTML = '';
            let longList = [];
            for (let i = 0; i < NUM_COPIES; i++) longList = longList.concat(excuses);
            longList.forEach(item => {
                const div = document.createElement('div');
                div.className = `phrase ${RARITY_CLASSES[item.rarity]}`;
                div.textContent = item.text;
                reelInner.appendChild(div);
            });
        }

        function getWeightedRandom() {
            let total = 0;
            excuses.forEach(e => total += RARITY_WEIGHTS[e.rarity]);
            let r = Math.random() * total;
            let sum = 0;
            for (let item of excuses) {
                sum += RARITY_WEIGHTS[item.rarity];
                if (r <= sum) return item;
            }
            return excuses[0];
        }

        function updateStatsDisplay(container) {
            container.innerHTML = '';
            if (Object.keys(stats).length === 0) {
                container.innerHTML = '<div class="text-zinc-500 text-center py-8">–ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –¥—Ä–æ—á–∏–ª</div>';
                return;
            }
            const grouped = { mythic:[], legend:[], epic:[], rare:[], common:[] };
            Object.keys(stats).forEach(key => {
                const item = excuses.find(e => e.text === key);
                if (item) grouped[item.rarity].push({text:key, count:stats[key], rarity:item.rarity});
            });
            RARITY_ORDER.forEach(r => {
                if (grouped[r].length) {
                    grouped[r].sort((a,b) => b.count - a.count);
                    grouped[r].forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'flex justify-between py-3 border-b border-zinc-700 last:border-none';
                        div.innerHTML = `
                            <span class="${RARITY_CLASSES[item.rarity]}">${item.text}</span>
                            <span class="font-mono text-zinc-300">${item.count}√ó</span>
                        `;
                        container.appendChild(div);
                    });
                }
            });
        }

        function spin() {
            if (isSpinning) return;
            if (!canSpinForFree() && !isDonated()) {
                showPaywall();
                return;
            }
            if (canSpinForFree()) useFreeSpin();
            isSpinning = true;
            const spinBtn = document.getElementById('spinBtn');
            const resultDiv = document.getElementById('result');
            resultDiv.classList.add('hidden');
            spinBtn.disabled = true;
            spinBtn.innerHTML = `<span class="animate-pulse">–ö–†–£–¢–ò–¢–°–Ø...</span>`;
            document.getElementById('startSound').currentTime = 0;
            document.getElementById('startSound').play().catch(() => {});
            const winner = getWeightedRandom();
            const winnerIndex = excuses.findIndex(item => item.text === winner.text);
            const fullSpins = 7 + Math.floor(Math.random() * 5);
            const targetIndex = fullSpins * excuses.length + winnerIndex;
            const reelHeight = document.getElementById('reel').clientHeight;
            const centerOffset = (reelHeight / 2) - (ITEM_HEIGHT / 2);
            const distance = (targetIndex * ITEM_HEIGHT) - centerOffset;
            const reelInner = document.getElementById('reel-inner');
            reelInner.style.transition = 'none';
            reelInner.style.transform = 'translateY(0px)';
            void reelInner.offsetWidth;
            reelInner.style.transition = 'transform 5360ms cubic-bezier(0.22, 0.07, 0.10, 0.99)';
            reelInner.style.transform = `translateY(-${distance}px)`;
            setTimeout(() => {
                isSpinning = false;
                spinBtn.disabled = false;
                spinBtn.innerHTML = `<span>–ü–ï–î–ê–õ–¨</span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m-7-7v14"/></svg>`;
                const winnerEl = document.getElementById('winnerText');
                winnerEl.innerHTML = `<span class="text-cyan-300">‚Äú</span>${winner.text}<span class="text-cyan-300">‚Äù</span>`;
                winnerEl.className = `text-3xl leading-tight font-semibold bg-zinc-900 border border-zinc-700 rounded-2xl px-8 py-6 min-h-[140px] flex items-center justify-center shadow-inner ${RARITY_CLASSES[winner.rarity]}`;
                const key = winner.text;
                stats[key] = (stats[key] || 0) + 1;
                localStorage.setItem("retroStats", JSON.stringify(stats));
                resultDiv.classList.remove('hidden');
                resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                document.getElementById('endSound').currentTime = 0;
                document.getElementById('endSound').play().catch(() => {});
            }, 5360);
        }

        function showModal() {
            const modal = document.getElementById('modal');
            const content = document.getElementById('statsContent');
            updateStatsDisplay(content);
            modal.style.display = 'flex';
        }

        function hideModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function resetStats() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?')) {
                localStorage.removeItem("retroStats");
                stats = {};
                updateStatsDisplay(document.getElementById('statsContent'));
            }
        }

        function copyToClipboard() {
            const text = document.getElementById('winnerText').textContent.trim().replace(/[‚Äú‚Äù]/g, '');
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('#result button:nth-child(1)');
                if (btn) {
                    const orig = btn.innerHTML;
                    btn.innerHTML = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ';
                    setTimeout(() => btn.innerHTML = orig, 1800);
                }
            }).catch(() => {});
        }

        function spinAgain() {
            document.getElementById('result').classList.add('hidden');
            setTimeout(spin, 120);
        }

        function markAsDonated() {
            localStorage.setItem("donatedRetro", JSON.stringify({ timestamp: Date.now() }));
        }

        window.onload = () => {
            createReel();
            document.getElementById('spinBtn').addEventListener('click', spin);
        };
    </script>
</body>
</html>

